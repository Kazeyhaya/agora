<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agora - Comunidades e Chat</title>
  <link rel="stylesheet" href="/assets/style.css">
  <link rel="icon" type="image/png" href="/assets/Agora-logo.png"> 
  <meta name="color-scheme" content="dark">
</head>
<body>

  <div id="toast-container"></div>

  <div class="login-overlay" id="login-view" hidden>
    <form class="login-card" id="login-form">
      <div class="brand-badge" style="margin-bottom: 12px; background: none;">
          <img src="/assets/Agora-logo.png" alt="Agora Logo">
      </div>
      <h2>Bem-vindo ao Agora</h2>
      <p class="meta" style="margin-bottom: 15px;">Entre ou Crie sua conta</p>
      <input class="input" id="login-username-input" placeholder="Usu√°rio" required style="width: 100%; text-align: center; margin-bottom: 8px;">
      <input class="input" id="login-password-input" type="password" placeholder="Senha" required style="width: 100%; text-align: center; margin-bottom: 12px;">
      <button class="send" type="submit" style="width: 100%;">Acessar</button>
    </form>
  </div>

  <div class="modal-overlay" id="input-modal" hidden>
    <form class="modal-card" id="modal-form">
      <h3 id="modal-title" style="margin-bottom: 15px;">T√≠tulo</h3>
      <textarea class="input" id="modal-input" style="width: 100%; min-height: 80px;"></textarea>
      <input class="input" id="modal-pass-input" type="password" style="width: 100%; display: none; margin-bottom: 10px;">
      <div style="display: flex; gap: 10px; width: 100%; margin-top: 10px;">
        <button class="mini-btn" type="button" id="modal-cancel-btn" style="flex: 1;">Cancelar</button>
        <button class="send" type="submit" id="modal-save-btn" style="flex: 2;">Salvar</button>
      </div>
    </form>
  </div>

  <div class="app" hidden>
    <aside class="servers">
      <div id="home-btn" class="server active" title="Agora">
        <img src="/assets/Agora-logo.png" style="width: 100%; height: 100%; object-fit: contain;">
      </div>
      <div class="divider"></div>
      <div id="joined-servers-list"></div>
      <div class="divider"></div>
      <button class="add-btn" id="explore-servers-btn" title="Explorar">+</button>
    </aside>

    <header class="header">
      <button class="icon-btn" id="btn-mobile-menu">‚ò∞</button>
      <div class="brand">
        <div class="brand-badge">A</div>
        <div class="brand-title">Agora</div>
      </div>
      <div class="header-actions">
        <button class="pill" id="btn-explore">Explorar</button>
      </div>
    </header>

    <aside class="channels" hidden>
      <button class="icon-btn" id="btn-community-menu">‚ò∞</button>
      <div class="community-card">
        <div class="avatar-display community-avatar" id="community-avatar-channel">AG</div>
        <div class="community-info">
          <div class="community-name" id="community-name-channel">Comunidade</div>
          <div class="community-sub" id="community-members-count">0 membros</div>
          <div style="margin-top: 8px; display: flex; gap: 8px;">
              <button class="mini-btn" id="btn-edit-community" hidden style="flex: 1;">Editar</button>
              <button class="mini-btn" id="btn-leave-community" hidden style="flex: 1; background: var(--danger);">Sair</button>
          </div>
        </div>
      </div>
      <div class="view-tabs" style="padding-left: 10px; margin-top: 10px;">
          <button class="pill active" data-community-view="topics">T√≥picos</button>
          <button class="pill" data-community-view="members">Membros</button> 
      </div>
    </aside>

    <section class="feed" id="view-feed">
      <div class="feed-top">
        <div class="chat-topic"><div class="topic-badge">Agora Feed</div><span class="meta">‚Äî Posts de quem voc√™ segue</span></div>
        <div class="chat-actions"><button class="icon-btn" id="btn-refresh">üîÑ</button></div>
      </div>
      
      <div class="composer-feed">
        <input class="input" id="feedInput" type="text" placeholder="Compartilhe algo..." />
        <button class="icon-btn" id="btn-add-image" title="Adicionar Imagem" style="margin-right: 8px;">üñºÔ∏è</button>
        <input type="file" id="feedImageInput" accept="image/*" hidden>
        <button class="send" id="feedSend">Publicar</button>
      </div>
      <div id="image-preview-container" style="padding: 0 12px 12px; display: none;">
          <div style="position: relative; display: inline-block;">
              <img id="image-preview" src="" style="max-height: 100px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1);">
              <button id="btn-remove-image" style="position: absolute; top: -5px; right: -5px; background: red; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px;">X</button>
          </div>
      </div>
      <div class="posts" id="posts"></div>
    </section>

    <main class="chat" id="view-chat" hidden>
      <div class="chat-top">
        <div class="chat-topic"><div class="topic-badge" id="topic">@ Utilizador</div></div>
      </div>
      <div class="messages" id="messages"></div>
      <div id="typing-indicator" class="typing-indicator" hidden>
        <span class="dots">...</span> <span id="typer-name">Algu√©m</span> est√° digitando
      </div>
      <div class="composer">
        <input class="input" id="composerInput" type="text" placeholder="Envie uma mensagem...">
        <button class="send" id="sendBtn">Enviar</button>
      </div>
    </main>
    
    <section class="profile" id="view-profile" hidden>
      <div class="profile-top"><div class="chat-topic"><div class="topic-badge">Perfil</div></div></div>
      <div class="profile-body">
        <div class="card">
          <div class="avatar-display profile-avatar" id="profileAvatar" style="width:64px;height:64px;border-radius:16px;margin-bottom:8px">VC</div>
          <label class="mini-btn" for="avatar-upload-input" id="avatar-upload-label" style="display: none; margin-bottom: 8px; justify-content: center;">Mudar Foto</label>
          <input type="file" id="avatar-upload-input" accept="image/*" hidden>
          
          <div><strong id="profileName">Voc√™</strong> <span id="profile-badges"></span></div>
          <div class="meta" id="profileBio">...</div>
          <div class="meta" id="profileMood" style="color:var(--orkut-pink); margin-top: 4px;"></div>
          <div id="profileVibe" class="vibe-box" hidden><span class="vibe-icon">üîÆ</span> <span id="profileVibeText"></span></div>

          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="mini-btn" id="editBioBtn">Editar bio</button>
            <button class="mini-btn" id="dmBtn" style="display: none;">Mensagem</button>
          </div>
          
          <div id="ratings-vote-container" hidden style="margin-top: 15px;">
            <div class="meta" style="margin-bottom: 8px;">Avalie este usu√°rio:</div>
            <div class="vote-grid">
                <button class="mini-btn" data-rating="confiavel">üòä Confi√°vel</button>
                <button class="mini-btn" data-rating="legal">üßä Legal</button>
                <button class="mini-btn" data-rating="divertido">ü•≥ Divertido</button>
                <button class="mini-btn" data-rating="falso">ü§• Falso</button>
                <button class="mini-btn" data-rating="chato">üò¥ Chato</button>
                <button class="mini-btn" data-rating="toxico">‚ò†Ô∏è T√≥xico</button>
            </div>
          </div>
        </div>
        
        <div class="card">
          <h3 style="margin-bottom:8px">Avalia√ß√µes</h3>
          <div class="ratings-display" id="ratings-display-container"></div>
          <h3 style="margin:12px 0 8px">Depoimentos</h3>
          <div id="testimonials" class="comments"></div>
          <div style="display:flex;gap:8px;margin-top:10px" id="testimonial-form-container">
            <input class="input" id="testimonialInput" placeholder="Escreva um depoimento..." />
            <button class="send" id="testimonialSend">Adicionar</button>
          </div>
          <h3 style="margin:12px 0 8px">Amigos</h3>
          <div class="friends" id="friends"></div>
          <h3 style="margin:16px 0 8px; font-size: 0.95rem; color: var(--text-secondary);">√öltimos Visitantes</h3>
          <div class="friends" id="recent-visitors"></div>
        </div>
      </div>
    </section>

    <section class="feed" id="view-explore" hidden>
      <div class="feed-top">
        <div class="chat-topic"><div class="topic-badge">Explorar</div><span class="meta">‚Äî Todos os posts da rede</span></div>
        <div class="chat-actions"><button class="icon-btn" id="btn-explore-refresh">üîÑ</button></div>
      </div>
      <div class="posts" id="explore-posts"></div>
    </section>

    <section class="explore-servers" id="view-explore-servers" hidden>
      <div class="explore-servers-top">
        <h2>Explorar Comunidades</h2>
        <button class="mini-btn" id="btn-show-create-community">Criar a Minha</button>
      </div>
      <div class="community-list" id="community-list-container"></div>
    </section>

    <section class="create-community" id="view-create-community" hidden>
      <div class="explore-servers-top"><h2>Criar Nova Comunidade</h2></div>
        <div class="profile-body" style="grid-template-columns: 1fr;">
            <div class="card" style="max-width: 600px;">
                <form id="create-community-form">
                    <label>Nome:</label> <input class="input" id="community-name" required>
                    <label style="margin-top:10px">Emoji:</label> <input class="input" id="community-emoji">
                    <button class="send" type="submit" style="margin-top: 15px;">Criar</button>
                    <button type="button" class="mini-btn" id="btn-cancel-create">Cancelar</button>
                </form>
            </div>
        </div>
    </section>
    
    <section class="community-content" id="view-community-topics" hidden>
      <div class="feed-top">
            <div class="chat-topic"><div class="topic-badge" id="current-community-name">Nome</div></div>
            <div class="chat-actions"><button class="mini-btn" id="btn-new-topic">Novo T√≥pico</button></div>
        </div>
        <div class="posts" id="community-topic-list"></div>
    </section>
    
    <section class="community-content profile-body" id="view-community-members" hidden style="grid-template-columns: 1fr;">
      <div class="explore-servers-top" style="border-bottom: none;"><h2 id="community-members-title">Membros</h2></div>
        <div class="card"><div class="friends" id="community-member-list"></div></div>
    </section>
    
    <section class="create-topic" id="view-create-topic" hidden>
       <div class="explore-servers-top"><h2>Criar Novo T√≥pico</h2></div>
        <div class="profile-body" style="grid-template-columns: 1fr;">
            <div class="card" style="max-width: 800px;">
                <form id="create-topic-form">
                    <label>T√≠tulo:</label> <input class="input" id="topic-title" required>
                    <label style="margin-top: 10px;">Conte√∫do:</label> <textarea class="input" id="topic-content" required style="min-height: 150px;"></textarea>
                    <button class="send" type="submit" style="margin-top: 15px;">Publicar</button>
                    <button type="button" class="mini-btn" id="btn-cancel-topic">Cancelar</button>
                </form>
            </div>
        </div>
    </section>

    <footer class="userbar">
      <div class="me clickable" id="userbar-me">
        <div class="avatar-display userbar-avatar" id="userAvatar">VC</div>
        <div>
          <div id="userName"><strong>Voc√™</strong></div>
          <div class="meta clickable" id="userbar-mood-container">Mood: <span id="userbar-mood" style="color:var(--orkut-pink)"></span></div>
        </div>
      </div>
      <div class="user-actions">
        <div class="presence" id="btn-status" title="Status"></div>
        <button class="icon-btn" id="btn-settings">‚öôÔ∏è</button>
        <button class="icon-btn" id="btn-logout">üö™</button>
      </div>
    </footer>
  </div>

  <script src="/socket.io/socket.io.js" defer></script>
  <script src="/assets/script.js" defer></script>
</body>
</html>